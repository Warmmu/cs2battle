<!--å¤§å…é¡µé¢-->
<view class="container">
  <view class="header">
    <view class="user-info">
      <text class="welcome">æ¬¢è¿, {{nickname}}</text>
      <button class="logout-btn" bindtap="onLogout">é€€å‡º</button>
    </view>
    <view class="actions">
      <button class="action-btn" bindtap="onViewHistory">æˆ˜ç»©</button>
      <button class="action-btn" bindtap="onViewRanking">æ’è¡Œæ¦œ</button>
    </view>
  </view>

  <view class="main" wx:if="{{!room}}">
    <!-- æˆ¿é—´ä¿¡æ¯å¡ç‰‡ -->
    <view class="room-info-card" wx:if="{{availableRooms.length > 0}}">
      <view class="info-header">
        <text class="info-title">å½“å‰æˆ¿é—´</text>
        <text class="info-count">{{availableRooms.length}} ä¸ªæˆ¿é—´ç­‰å¾…ä¸­</text>
      </view>
      <view class="room-list">
        <view class="room-card" wx:for="{{availableRooms}}" wx:key="_id">
          <view class="room-status">
            <text class="status-badge {{item.status === 'ready' ? 'ready' : 'waiting'}}">
              {{item.status === 'ready' ? 'å‡†å¤‡ä¸­' : 'ç­‰å¾…ä¸­'}}
            </text>
          </view>
          <view class="room-players">
            <text class="player-icon">ğŸ‘¥</text>
            <text class="player-count">{{item.player_count}}/10 äºº</text>
          </view>
        </view>
      </view>
    </view>
    
    <view class="empty">
      <image class="empty-icon" src="/images/icons/home.png"></image>
      <text class="empty-text" wx:if="{{availableRooms.length > 0}}">
        ç‚¹å‡»åŠ å…¥ç°æœ‰æˆ¿é—´æˆ–åˆ›å»ºæ–°æˆ¿é—´
      </text>
      <text class="empty-text" wx:else>
        å‡†å¤‡å¼€å§‹ä¸€åœºæ¿€çƒˆçš„å¯¹æˆ˜ï¼Ÿ
      </text>
      <button class="join-btn" bindtap="onJoinRoom">
        {{availableRooms.length > 0 ? 'åŠ å…¥æˆ¿é—´' : 'åˆ›å»ºæˆ¿é—´'}}
      </button>
    </view>
  </view>

  <view class="room" wx:else>
    <view class="room-header">
      <text class="room-title">æˆ¿é—´ ({{room.players.length}}/10)</text>
      <button class="leave-btn" bindtap="onLeaveRoom">ç¦»å¼€</button>
    </view>

    <view class="players">
      <view 
        class="player-item {{item.ready ? 'ready' : ''}}" 
        wx:for="{{room.players}}" 
        wx:key="player_id"
      >
        <view class="player-info">
          <text class="player-name">{{item.nickname}}</text>
          <text class="player-elo">ELO: {{item.elo}}</text>
        </view>
        <view class="player-status">
          <text class="status-text">{{item.ready ? 'âœ“ å·²å‡†å¤‡' : 'æœªå‡†å¤‡'}}</text>
        </view>
      </view>
    </view>

    <view class="room-footer">
      <button class="ready-btn" bindtap="onReady">
        {{currentPlayerReady ? 'å–æ¶ˆå‡†å¤‡' : 'å‡†å¤‡'}}
      </button>
      
      <view class="tips">
        <text wx:if="{{room.players.length < 2}}">
          ç­‰å¾…æ›´å¤šç©å®¶åŠ å…¥ï¼ˆè‡³å°‘éœ€è¦2äººï¼‰
        </text>
        <text wx:elif="{{room.status === 'ready'}}">
          æ‰€æœ‰äººå·²å‡†å¤‡ï¼Œå³å°†å¼€å§‹åŒ¹é…...
        </text>
        <text wx:else>
          ç­‰å¾…æ‰€æœ‰ç©å®¶å‡†å¤‡
        </text>
      </view>
    </view>
  </view>
</view>

