# CS2 BP系统 - 本地存储版本

## 更新说明 (2025-11-07)

本次更新已将系统从后端数据库改为浏览器本地存储（localStorage），无需启动后端服务器即可使用。

### 主要改进

#### 1. 本地存储替代数据库 ✅
- **无需后端服务器** - 所有数据保存在浏览器 localStorage 中
- **即开即用** - 直接用浏览器打开 `index.html` 即可使用
- **数据持久化** - 数据会保存在浏览器中，关闭页面后数据不丢失
- **多标签页支持** - 同一浏览器的不同标签页可以独立操作

#### 2. 修复比赛成绩登记回档问题 ✅
- **移除轮询机制** - 不再从服务器同步数据
- **实时本地保存** - 输入数据后0.5秒自动保存
- **保存时间提示** - 显示最后保存时间，带数字变化动画
- **不会数据回档** - 不再出现输入数据被覆盖的问题

#### 3. 丰富的动画效果 ✨
新增多种动画，提升用户体验：

**页面级动画**
- 页面加载淡入动画（fadeIn, fadeInUp）
- 头部导航栏滑入动画（slideInFromTop）
- 卡片延迟进入动画（按顺序依次出现）

**元素交互动画**
- 按钮 hover 脉冲动画（pulse）
- 卡片 hover 上浮动画
- 输入框 focus 放大高亮动画
- 地图卡片悬停发光动画（glow）

**状态变化动画**
- Toast 通知滑入动画
- 模态框缩放进入动画（scaleIn）
- 数字变化强调动画（numberChange）
- 玩家准备状态弹跳动画（bounce）
- 地图被Ban震动动画（shake）
- 地图被Pick脉冲发光动画

**数据反馈动画**
- ELO增加：绿色弹跳动画
- ELO减少：红色震动动画
- 房间列表滑入动画
- 历史记录淡入上浮动画

## 使用方法

### 快速开始

1. **打开系统**
   ```
   直接用浏览器打开：frontend/index.html
   ```

2. **注册账号**
   - 首次使用需要注册
   - 输入昵称（必填）
   - Steam ID 可选

3. **开始游戏**
   - 登录后自动进入大厅
   - 点击"加入/创建房间"
   - 等待玩家准备
   - 开始 BP 选图
   - 录入比赛成绩

### 功能页面

#### 登录/注册 (index.html / register.html)
- 注册新账号或登录现有账号
- 带有优雅的卡片缩放进入动画

#### 大厅 (lobby.html)
- 加入或创建房间
- 查看房间玩家列表
- 准备/取消准备
- 查看战绩和排行榜

#### BP选图 (bp.html)
- A队和B队轮流 Ban 地图
- 投票机制：队伍中超过半数投票生效
- 最后剩一张地图自动选定
- 实时显示 BP 历史

#### 比赛录入 (match.html)
- 录入比分
- 填写每位玩家的 K/D/A 数据
- 自动计算 K/D 比
- 实时本地保存（0.5秒防抖）
- **不会出现数据回档问题**
- 提交后自动计算 ELO 变化

#### 历史战绩 (history.html)
- 查看个人总战绩
- 查看比赛历史记录
- 显示每场比赛的详细数据

#### 排行榜 (ranking.html)
- 查看所有玩家排名
- 按 ELO 降序排列
- 显示详细统计数据

### 测试页面

#### test.html
专门的测试页面，包含：
- **测试动画效果** - 查看各种动画效果
- **测试本地存储** - 测试数据库功能
- **清空本地数据** - 重置所有数据

使用方法：
```
浏览器打开：frontend/test.html
```

## 技术细节

### 本地存储结构

```javascript
{
  cs2_db: {
    players: [],        // 玩家信息
    rooms: [],          // 房间信息
    matches: [],        // 比赛记录
    bp_sessions: [],    // BP会话
    player_stats: [],   // 玩家统计
    elo_history: [],    // ELO历史
    version: '1.0'
  }
}
```

### 新增文件

- `frontend/js/localStorage-db.js` - 本地数据库管理模块
- `frontend/test.html` - 功能测试页面
- `frontend/README_本地版本.md` - 本文档

### 修改文件

- `frontend/js/api.js` - 改为使用本地存储API
- `frontend/css/style.css` - 新增大量动画效果
- `frontend/match.html` - 修复数据回档问题，移除轮询
- `frontend/lobby.html` - 移除轮询机制
- `frontend/bp.html` - 移除轮询机制
- 所有HTML文件 - 添加 localStorage-db.js 引用

## 动画列表

### 关键帧动画
- `fadeIn` - 淡入
- `fadeInUp` - 上浮淡入
- `fadeInLeft` - 左侧滑入
- `fadeInRight` - 右侧滑入
- `scaleIn` - 缩放淡入
- `slideDown` - 下滑淡入
- `pulse` - 脉冲
- `bounce` - 弹跳
- `shake` - 震动
- `glow` - 发光
- `slideInFromTop` - 顶部滑入
- `numberChange` - 数字变化高亮

### 动画应用
- 所有卡片：`fadeInUp` 0.5s，带延迟
- 页面头部：`slideInFromTop` 0.4s
- 按钮hover：`pulse` 无限循环
- 地图hover：`glow` 无限循环
- 玩家准备：`bounce` 1s
- 地图被Ban：`shake` 0.5s
- 模态框：`scaleIn` 0.3s

## 注意事项

### 浏览器兼容性
- 推荐使用 Chrome, Edge, Firefox 最新版本
- 需要支持 localStorage 和 ES6+
- 不支持 IE 浏览器

### 数据管理
- 数据保存在浏览器 localStorage 中
- 不同浏览器的数据相互独立
- 清除浏览器数据会丢失所有记录
- 建议定期导出重要数据（功能待开发）

### 多人使用
- 同一设备可以注册多个账号
- 通过注销切换账号
- 多个标签页可以独立操作
- 不支持跨设备同步（需后端支持）

### 性能优化
- 防抖机制：输入0.5秒后自动保存
- 动画使用 CSS 硬件加速
- 最小化重绘和回流
- 数据按需加载

## 已知限制

1. **单机使用** - 无法实现真正的多人在线对战
2. **数据隔离** - 不同浏览器/设备之间数据不互通
3. **无实时同步** - 多标签页之间不会实时同步状态
4. **存储限制** - localStorage 通常限制 5-10MB

## 开发计划

### 短期计划
- [ ] 添加数据导出/导入功能
- [ ] 添加更多动画效果
- [ ] 优化移动端适配
- [ ] 添加暗色主题

### 长期计划
- [ ] 可选的后端同步功能
- [ ] 实时对战功能
- [ ] 聊天系统
- [ ] 成就系统

## 更新日志

### v2.0.0 (2025-11-07)
- ✨ 改为本地存储，无需后端服务器
- 🐛 修复比赛成绩登记数据回档问题
- ✨ 新增20+种动画效果
- 🎨 优化UI交互体验
- 📝 移除轮询机制
- 🧪 新增测试页面
- 📚 完善文档

### v1.0.0 (之前)
- 基础功能实现
- 后端数据库版本

## 问题反馈

如有问题或建议，请联系开发者。

---

**享受游戏！ Have Fun! 🎮**

